<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>è‡ªå»ºèŒ§æˆ¿ | TrendRadar</title>
<link rel="icon" href="./img/trend-icon.png" />
<meta name="description" content="è‡ªå»ºèŒ§æˆ¿ Â· è¶‹åŠ¿æ´å¯Ÿé¢æ¿" />

<style>
  :root{
    --bg:#0b1018; --panel:#0f1622; --text:#e6edf6; --sub:#94a3b8;
    --brand:#7aa2ff; --line:#253041; --chip:#162238; --chipText:#cbd5e1;
  }
  .light{
    --bg:#f5f7fb; --panel:#ffffff; --text:#0f172a; --sub:#6b7280;
    --brand:#2563eb; --line:#e5e7eb; --chip:#eff4fb; --chipText:#1f2937;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    background:var(--bg); color:var(--text);
    font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei","Inter",sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* ===== é¡¶æ å˜ä¸ºæ¸éšï¼Œä¸å†æ˜¯ç¡¬åˆ†å‰²çº¿ ===== */
  .topbar{
    height:56px; display:flex; align-items:center; justify-content:space-between;
    padding:0 18px; color:var(--text); position:sticky; top:0; z-index:50;
    background:linear-gradient(180deg, rgba(8,12,20,.55), rgba(8,12,20,.10) 60%, transparent);
    backdrop-filter:blur(6px);
  }
  .brand{display:flex;align-items:center;gap:10px;font-weight:700}
  .brand img{width:22px;height:22px}
  .btn{
    border:1px solid rgba(255,255,255,.12); background:transparent; color:var(--text);
    padding:6px 10px; border-radius:10px; cursor:pointer; font-size:.92rem;
  }
  .btn:hover{background:rgba(255,255,255,.06)}

  /* ===== é¡¶éƒ¨å¤§å›¾ï¼šåº•éƒ¨æ¸å˜æ¶ˆå¤± + ç»ç’ƒä¿¡æ¯æ¡å‹åœ¨å›¾ä¸Š ===== */
  .hero{
    position:relative; height:260px; overflow:hidden;
    background:url('https://picx.zhimg.com/v2-53929aa63157aa2c5ff6fb2ecc22094b_r.jpg') center/cover no-repeat;
  }
  /* åº•éƒ¨æ¸éšåˆ°é¡µé¢èƒŒæ™¯ï¼ˆæ— ç¡¬çº¿ï¼‰ */
  .hero::after{
    content:""; position:absolute; inset:0;
    background:linear-gradient(180deg, rgba(12,18,30,.25) 0%, rgba(12,18,30,.55) 55%, rgba(12,18,30,0) 100%);
    pointer-events:none;
  }
  /* å†ç”¨ mask åšâ€œæ¶ˆå¤±è¾¹ç¼˜â€ï¼Œä¸åŒæµè§ˆå™¨å…œåº• */
  .hero{ -webkit-mask-image:linear-gradient(to bottom, rgba(0,0,0,1) 72%, rgba(0,0,0,0) 100%);
         mask-image:linear-gradient(to bottom, rgba(0,0,0,1) 72%, rgba(0,0,0,0) 100%); }

  .hero-inner{
    position:relative; z-index:1; height:100%;
    display:flex; flex-direction:column; justify-content:flex-end;
    padding:26px 22px 96px; /* é¢„ç•™åº•éƒ¨ä¿¡æ¯æ¡é«˜åº¦ */
  }
  .hero-title{font-size:22px;font-weight:800;letter-spacing:.5px}
  .hero-sub{color:var(--sub);margin-top:6px;font-size:.92rem}

  /* ===== ä¸¤æ¡â€œé•¿æ¡â€åšç»ç’ƒæ‹Ÿæ€ï¼Œæ‚¬æµ®åœ¨å›¾ç‰‡ä¸Š ===== */
  .floating-bars{
    position:absolute; left:22px; right:22px; bottom:22px; z-index:2;
    display:grid; grid-template-columns:2fr 1fr 1fr; gap:12px;
  }
  .glass{
    background:rgba(15,22,34,.52);
    border:1px solid rgba(255,255,255,.12);
    box-shadow:0 8px 20px rgba(0,0,0,.28);
    backdrop-filter:blur(8px);
    color:var(--text); border-radius:14px; padding:12px 14px;
    display:flex; align-items:center; justify-content:space-between;
    min-height:44px;
  }
  .glass h4{margin:0;font-size:.92rem;color:var(--sub);font-weight:600}
  .glass b{font-size:18px}

  /* å†…å®¹å®¹å™¨å‘ä¸Šå ä¸€ç‚¹ï¼Œé…åˆ hero æ¸éšæ— ç¼è¡”æ¥ */
  .container{padding:0 22px 40px;max-width:1200px;margin:-36px auto 0}
  .grid{display:grid;grid-template-columns:2.1fr 1fr;gap:18px}

  .card{
    background:var(--panel); border:1px solid var(--line);
    border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,.22); overflow:hidden;
  }
  .card-hd{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
  .card-hd h3{margin:0;font-size:16px;font-weight:800;color:var(--brand)}
  .card-bd{padding:10px 12px 12px}
  .news-item{padding:12px 8px;border-bottom:1px solid var(--line);display:flex;flex-direction:column;gap:6px}
  .news-item:last-child{border-bottom:none}
  .news-title{margin:0;font-size:15px;line-height:1.45}
  .meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--sub);font-size:.88rem}
  .badge{background:var(--chip);color:var(--chipText);border:1px solid var(--line);
         border-radius:999px;padding:2px 8px;font-size:.8rem}
  .chips{display:flex;flex-wrap:wrap;gap:10px}
  .chip{background:var(--chip);border:1px solid var(--line);color:var(--chipText);
        padding:8px 12px;border-radius:999px;font-size:.92rem}
  .chip:hover{background:#1a2a44}
  .footer{text-align:center;padding:28px 12px;color:var(--sub);font-size:.9rem}

  @media(max-width:980px){
    .floating-bars{grid-template-columns:1fr;gap:10px}
    .hero-inner{padding:22px 16px 120px}
    .container{margin:-28px auto 0}
    .grid{grid-template-columns:1fr}
  }
</style>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img src="./img/trend-icon.png" alt="logo" />
      <span>è‡ªå»ºèŒ§æˆ¿ | TrendRadar</span>
    </div>
    <div>
      <span id="uptime">æ›´æ–°ä¸­â€¦</span>
      <button class="btn" id="themeBtn">åˆ‡æ¢ä¸»é¢˜</button>
    </div>
  </header>

  <section class="hero">
    <div class="hero-inner">
      <div class="hero-title">è‡ªå»ºèŒ§æˆ¿ Â· è¶‹åŠ¿æ´å¯Ÿé¢æ¿</div>
      <div class="hero-sub">æ²‰æ·€æ€è€ƒ Â· å®ˆæŠ¤ä¸“æ³¨ Â· è‡ªåŠ¨è¿½è¸ªå…¨çƒä¿¡æ¯è„‰ç»œ</div>
    </div>

    <!-- ä¸¤ä¸ªâ€œé•¿æ¡â€ + æ•°é‡æ¡ èåˆåœ¨å›¾ä¸Š -->
    <div class="floating-bars">
      <div class="glass"><h4>æŠ¥å‘Šç±»å‹</h4><b>å½“æ—¥æ±‡æ€»</b></div>
      <div class="glass"><h4>çƒ­ç‚¹æ–°é—»</h4><b id="stat-news">â€”</b></div>
      <div class="glass"><h4>ç”Ÿæˆæ—¶é—´</h4><b id="stat-time">â€”</b></div>
    </div>
  </section>

  <main class="container">
    <div class="grid">
      <section class="card">
        <div class="card-hd"><h3>ğŸ“Œ ä»Šæ—¥é‡ç‚¹è¶‹åŠ¿</h3></div>
        <div class="card-bd" id="newsList">
          <div class="news-item"><p class="news-title">åŠ è½½ä¸­â€¦</p><div class="meta"><span>æ¥æºï¼šâ€”</span></div></div>
        </div>
      </section>

      <aside class="card">
        <div class="card-hd"><h3>ğŸ”¥ çƒ­æœå…³é”®è¯</h3></div>
        <div class="card-bd"><div class="chips" id="kwChips"><span class="chip">åŠ è½½ä¸­â€¦</span></div></div>
      </aside>
    </div>
  </main>

  <footer class="footer">
    Â© 2025 è‡ªå»ºèŒ§æˆ¿ | æ•°æ®æºï¼šåå°”è¡—è§é—» Â· æ–°æµªè´¢ç» Â· ç™¾åº¦æŒ‡æ•°
  </footer>

<script>
  /* ä¸»é¢˜åˆ‡æ¢ */
  const KEY="tr-theme",btn=document.getElementById("themeBtn");
  const apply=t=>{t==="light"?document.documentElement.classList.add("light")
                         :document.documentElement.classList.remove("light")};
  apply(localStorage.getItem(KEY)||"dark");
  btn.onclick=()=>{const n=document.documentElement.classList.contains("light")?"dark":"light";
                   apply(n);localStorage.setItem(KEY,n)}

  /* æ•°æ®æ¸²æŸ“ */
  const newsEl=document.getElementById("newsList"),
        kwEl=document.getElementById("kwChips"),
        statNews=document.getElementById("stat-news"),
        statTime=document.getElementById("stat-time"),
        upEl=document.getElementById("uptime");
  const TRENDS_URL="/TrendRadar/api/trends.json";

  async function j(u){try{const r=await fetch(u,{cache:"no-store"});if(!r.ok)throw 0;return await r.json()}catch{return null}}
  function uniq(arr,by){const m=new Map();arr.forEach(x=>{const k=by(x);if(!m.has(k))m.set(k,x)});return[...m.values()]}
  function empty(){
    newsEl.innerHTML=`<div class="news-item"><p class="news-title">æš‚æ— æ•°æ®</p><div class="meta"><span>æ£€æŸ¥ /api/trends.json</span></div></div>`;
    kwEl.innerHTML=`<span class="chip">æš‚æ— å…³é”®è¯</span>`; statNews.textContent="0 æ¡";
    const t=new Date().toLocaleString("zh-CN",{hour12:false}); statTime.textContent=t; upEl.textContent="æ›´æ–°äº "+t;
  }
  function render(d){
    const t=d.generated_at?new Date(d.generated_at):new Date();
    const ts=t.toLocaleString("zh-CN",{hour12:false}); statTime.textContent=ts; upEl.textContent="æ›´æ–°äº "+ts;

    let items=[]; (d.trends||[]).forEach(g=>(g.titles||[]).forEach(t=>{
      items.push({k:g.keyword_group||"", title:t.title||"", url:t.url||"", src:t.source||"", cnt:t.appearance_count||""})
    }));
    items=uniq(items,x=>x.title).slice(0,30); statNews.textContent=(items.length||0)+" æ¡";
    if(!items.length){empty();return;}
    newsEl.innerHTML=items.map(n=>`<div class="news-item">
      <p class="news-title"><a href="${n.url}" target="_blank" rel="noopener" style="color:inherit;text-decoration:none">${n.title.replace(/</g,"&lt;")}</a></p>
      <div class="meta"><span>æ¥æºï¼š${n.src||"æœªçŸ¥"}</span>${n.cnt?`<span>å‡ºç°ï¼š${n.cnt}æ¬¡</span>`:""}${n.k?`<span class="badge">${n.k}</span>`:""}</div>
    </div>`).join("");

    const kws=uniq((d.trends||[]).map(g=>g.keyword_group).filter(Boolean),x=>x);
    kwEl.innerHTML=kws.length?kws.slice(0,24).map(k=>`<span class="chip">${k}</span>`).join("")
                       :`<span class="chip">æš‚æ— å…³é”®è¯</span>`;
  }
  (async()=>{const d=await j(TRENDS_URL); if(!d){empty();return;} render(d)})();
</script>
</body>
</html>
